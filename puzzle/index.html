<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gate</title>
<style>
  body{
    background:#000;
    color:#ccc;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
    text-align:center;
    padding:8vh 14px;
  }
  .ok{color:#6f6;}
  .bad{color:#f66;}
  .box{
    max-width:720px;
    margin:0 auto;
    text-align:left;
    border:1px solid rgba(255,255,255,.15);
    border-radius:12px;
    padding:16px 16px 10px;
    background:rgba(255,255,255,.04);
  }
  .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;}
  input{
    width:100%;
    padding:12px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,.18);
    background:rgba(0,0,0,.35);
    color:#ccc;
    outline:none;
    font-size:16px;
  }
  button{
    margin-top:10px;
    padding:10px 14px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,.18);
    background:rgba(255,255,255,.08);
    color:#ccc;
    font-size:16px;
  }
  .small{
    font-size:12px;
    opacity:.65;
    margin-top:14px;
    word-break:break-all;
  }
  #puzzle { display:none; }
</style>
</head>
<body>

<h1 id="status">Checking…</h1>
<div id="detail"></div>

<div id="puzzle" class="box">
  <h2 class="ok" style="margin-top:0;">SAMALAMADINGDONG</h2>
  <p style="margin-bottom:8px;">
    Welcome. One page. One key. No hints.
  </p>

  <p class="mono" style="margin:12px 0 6px;">CLUE A (read carefully):</p>
  <div class="mono" style="line-height:1.55; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.12);">
    I speak without a mouth and hear without ears.<br>
    I have no body, but I come alive with wind.<br><br>
    If you know me, type me in lowercase.<br>
    (Spaces and punctuation don’t matter.)
  </div>

  <div style="margin-top:12px;">
    <input id="answer" autocomplete="off" autocapitalize="none" spellcheck="false" placeholder="enter answer…" />
    <button id="submit">submit</button>
    <div id="msg" style="margin-top:10px;"></div>
  </div>

  <div id="reveal" style="display:none; margin-top:14px;">
    <p class="mono" style="margin:12px 0 6px;">CLUE B (keep going):</p>
    <div class="mono" style="line-height:1.55; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.12);">
      19-8-5  14-5-24-20  11-5-25  9-19  8-9-4-4-5-14<br><br>
      Decode with A1Z26. The result is your next word.<br>
      (Again: lowercase. No spaces.)
    </div>
  </div>
</div>

<div class="small" id="ua"></div>

<script>
(function(){
  const ua = navigator.userAgent || "";
  document.getElementById("ua").textContent = ua;

  // --- Gate: iOS + Safari + Version/26.x ---
  const isIOS = /iPhone|iPad|iPod/.test(ua);
  const isSafari = /Safari\//.test(ua) && !/CriOS|FxiOS|EdgiOS/.test(ua);
  const safariVerMatch = ua.match(/Version\/(\d+(?:\.\d+)?)/);

  function fail(msg){
    document.getElementById("status").textContent = msg;
    document.getElementById("status").className = "bad";
  }

  if (!isIOS || !isSafari || !safariVerMatch) {
    fail("Unsupported browser");
    document.getElementById("detail").textContent = "Requires iOS Safari 26.x";
    return;
  }

  const safariVer = parseFloat(safariVerMatch[1]);
  const safariMajor = Math.floor(safariVer);

  if (safariMajor !== 26) {
    fail("Out of date");
    document.getElementById("detail").textContent = `Requires Safari 26.x (you have ${safariVerMatch[1]})`;
    return;
  }

  // Pass
  document.getElementById("status").textContent = "Access granted";
  document.getElementById("status").className = "ok";
  document.getElementById("detail").textContent = `Safari Version: ${safariVerMatch[1]}`;
  document.getElementById("puzzle").style.display = "block";

  // --- Puzzle logic ---
  const normalize = s => (s || "").toLowerCase().replace(/[^a-z0-9]/g,"");

  // Answer to CLUE A (classic riddle): "echo"
  const expected = "echo";

  const answerEl = document.getElementById("answer");
  const msgEl = document.getElementById("msg");
  const revealEl = document.getElementById("reveal");

  function check(){
    const guess = normalize(answerEl.value);
    if (!guess) return;

    if (guess === expected) {
      msgEl.innerHTML = '<span class="ok">Correct.</span> Keep going.';
      revealEl.style.display = "block";
    } else {
      msgEl.innerHTML = '<span class="bad">Nope.</span> Try again.';
      revealEl.style.display = "none";
    }
  }

  document.getElementById("submit").addEventListener("click", check);
  answerEl.addEventListener("keydown", (e) => { if (e.key === "Enter") check(); });

})();
</script>

</body>
</html>